<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="toolkit" content="width=device-width, initial-scale=1.0">
    <title>Daily Advice</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
            position: relative;
        }

        /* Starfield Canvas */
        #starfield {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        .page-wrapper {
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
            justify-content: center;
            max-width: 1300px;
            position: relative;
            z-index: 1;
        }

        .container {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.85) 0%, rgba(255, 255, 255, 0.75) 100%);
            border-radius: 20px;
            padding: 50px 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5), 0 0 40px rgba(100, 100, 255, 0.1);
            max-width: 600px;
            width: 100%;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        h1 {
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .advice-button {
            background: linear-gradient(135deg, #00b894 0%, #0984e3 100%);
            color: white;
            border: none;
            padding: 18px 40px;
            font-size: 1.2em;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-weight: 600;
            margin-bottom: 30px;
        }

        .advice-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(9, 132, 227, 0.4);
        }

        .advice-button:active {
            transform: translateY(0);
        }

        .reto-button {
            background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%);
            color: white;
            border: none;
            padding: 18px 40px;
            font-size: 1.2em;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-weight: 600;
            margin-bottom: 30px;
        }

        .reto-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(155, 89, 182, 0.4);
        }

        .reto-button:active {
            transform: translateY(0);
        }

        .advice-box {
            background: rgba(248, 249, 250, 0.9);
            border-left: 4px solid #0984e3;
            padding: 25px;
            border-radius: 10px;
            min-height: 100px;
            display: none;
            animation: fadeIn 0.5s;
        }

        .advice-box.show {
            display: block;
        }

        .reto-box {
            background: rgba(248, 249, 250, 0.9);
            border-left: 4px solid #9b59b6;
            padding: 25px;
            border-radius: 10px;
            min-height: 100px;
            display: none;
            animation: fadeIn 0.5s;
            max-height: 600px;
            overflow-y: auto;
        }

        .reto-box.show {
            display: block;
        }

        .advice-text {
            color: #555;
            font-size: 1.2em;
            line-height: 1.6;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <canvas id="starfield"></canvas>
    
    <div class="page-wrapper">
        <div class="container">
            <h1>Consejo</h1>
            <button class="advice-button" onclick="showAdvice()">click</button>
            <div class="advice-box" id="adviceBox">
                <p class="advice-text" id="adviceText"></p>
            </div>
        </div>

        <div class="container">
            <h1>Reto</h1>
            <button class="reto-button" onclick="showReto()">click</button>
            <div class="reto-box" id="retoBox">
                <p class="advice-text" id="retoText"></p>
            </div>
        </div>
    </div>

<script>
  // ==================== STARFIELD ANIMATION ====================
  const canvas = document.getElementById('starfield');
  const ctx = canvas.getContext('2d');
  
  let stars = [];
  let shootingStars = [];
  const numStars = 200;
  const numConstellationStars = 15;
  let constellationStars = [];
  
  function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    initStars();
  }
  
  function initStars() {
    stars = [];
    constellationStars = [];
    
    // Regular twinkling stars
    for (let i = 0; i < numStars; i++) {
      stars.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        radius: Math.random() * 1.5 + 0.5,
        opacity: Math.random(),
        twinkleSpeed: Math.random() * 0.02 + 0.005,
        twinkleDirection: Math.random() > 0.5 ? 1 : -1
      });
    }
    
    // Constellation stars (brighter, connected)
    for (let i = 0; i < numConstellationStars; i++) {
      constellationStars.push({
        x: Math.random() * canvas.width * 0.6 + canvas.width * 0.2,
        y: Math.random() * canvas.height * 0.6 + canvas.height * 0.2,
        radius: Math.random() * 2 + 1.5,
        opacity: Math.random() * 0.3 + 0.7,
        twinkleSpeed: Math.random() * 0.01 + 0.005,
        twinkleDirection: Math.random() > 0.5 ? 1 : -1,
        vx: (Math.random() - 0.5) * 0.1,
        vy: (Math.random() - 0.5) * 0.1
      });
    }
  }
  
  function createShootingStar() {
    if (Math.random() < 0.003) { // Occasional shooting star
      shootingStars.push({
        x: Math.random() * canvas.width,
        y: 0,
        length: Math.random() * 80 + 50,
        speed: Math.random() * 8 + 6,
        angle: Math.PI / 4 + (Math.random() - 0.5) * 0.3,
        opacity: 1
      });
    }
  }
  
  function drawStars() {
    // Draw regular stars
    stars.forEach(star => {
      // Twinkle effect
      star.opacity += star.twinkleSpeed * star.twinkleDirection;
      if (star.opacity >= 1 || star.opacity <= 0.2) {
        star.twinkleDirection *= -1;
      }
      
      ctx.beginPath();
      ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
      ctx.fillStyle = `rgba(255, 255, 255, ${star.opacity})`;
      ctx.fill();
    });
  }
  
  function drawConstellations() {
    // Move constellation stars slightly
    constellationStars.forEach(star => {
      star.x += star.vx;
      star.y += star.vy;
      
      // Bounce off edges gently
      if (star.x < canvas.width * 0.1 || star.x > canvas.width * 0.9) star.vx *= -1;
      if (star.y < canvas.height * 0.1 || star.y > canvas.height * 0.9) star.vy *= -1;
      
      // Twinkle
      star.opacity += star.twinkleSpeed * star.twinkleDirection;
      if (star.opacity >= 1 || star.opacity <= 0.5) {
        star.twinkleDirection *= -1;
      }
    });
    
    // Draw connections between nearby constellation stars
    ctx.strokeStyle = 'rgba(150, 180, 255, 0.15)';
    ctx.lineWidth = 1;
    
    for (let i = 0; i < constellationStars.length; i++) {
      for (let j = i + 1; j < constellationStars.length; j++) {
        const dx = constellationStars[i].x - constellationStars[j].x;
        const dy = constellationStars[i].y - constellationStars[j].y;
        const distance = Math.sqrt(dx * dx + dy * dy);
        
        if (distance < 200) {
          const opacity = (1 - distance / 200) * 0.3;
          ctx.strokeStyle = `rgba(150, 180, 255, ${opacity})`;
          ctx.beginPath();
          ctx.moveTo(constellationStars[i].x, constellationStars[i].y);
          ctx.lineTo(constellationStars[j].x, constellationStars[j].y);
          ctx.stroke();
        }
      }
    }
    
    // Draw constellation stars with glow
    constellationStars.forEach(star => {
      // Glow effect
      const gradient = ctx.createRadialGradient(star.x, star.y, 0, star.x, star.y, star.radius * 4);
      gradient.addColorStop(0, `rgba(200, 220, 255, ${star.opacity})`);
      gradient.addColorStop(0.5, `rgba(150, 180, 255, ${star.opacity * 0.3})`);
      gradient.addColorStop(1, 'rgba(150, 180, 255, 0)');
      
      ctx.beginPath();
      ctx.arc(star.x, star.y, star.radius * 4, 0, Math.PI * 2);
      ctx.fillStyle = gradient;
      ctx.fill();
      
      // Core star
      ctx.beginPath();
      ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
      ctx.fillStyle = `rgba(255, 255, 255, ${star.opacity})`;
      ctx.fill();
    });
  }
  
  function drawShootingStars() {
    shootingStars = shootingStars.filter(star => {
      star.x += Math.cos(star.angle) * star.speed;
      star.y += Math.sin(star.angle) * star.speed;
      star.opacity -= 0.01;
      
      if (star.opacity <= 0 || star.x > canvas.width || star.y > canvas.height) {
        return false;
      }
      
      // Draw shooting star trail
      const gradient = ctx.createLinearGradient(
        star.x, star.y,
        star.x - Math.cos(star.angle) * star.length,
        star.y - Math.sin(star.angle) * star.length
      );
      gradient.addColorStop(0, `rgba(255, 255, 255, ${star.opacity})`);
      gradient.addColorStop(1, 'rgba(255, 255, 255, 0)');
      
      ctx.beginPath();
      ctx.moveTo(star.x, star.y);
      ctx.lineTo(
        star.x - Math.cos(star.angle) * star.length,
        star.y - Math.sin(star.angle) * star.length
      );
      ctx.strokeStyle = gradient;
      ctx.lineWidth = 2;
      ctx.stroke();
      
      // Bright head
      ctx.beginPath();
      ctx.arc(star.x, star.y, 2, 0, Math.PI * 2);
      ctx.fillStyle = `rgba(255, 255, 255, ${star.opacity})`;
      ctx.fill();
      
      return true;
    });
  }
  
  function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    createShootingStar();
    drawStars();
    drawConstellations();
    drawShootingStars();
    
    requestAnimationFrame(animate);
  }
  
  window.addEventListener('resize', resizeCanvas);
  resizeCanvas();
  animate();

  // ==================== ORIGINAL APP LOGIC ====================
  const tips = [
    "Capítulo 1 – La respuesta correcta: Las respuestas que obtienes dependen de las preguntas que hagas; formula la misma duda de varias formas para descubrir soluciones distintas.",
    "Capítulo 1 – La respuesta correcta: Juega con tus palabras para obtener diferentes respuestas; una técnica útil es pedir múltiples soluciones en vez de una sola.",
    "Capítulo 1 – La respuesta correcta: Haz preguntas que alteren el pensamiento de la gente (rompen el modo automático y obligan a replantear).",
    "Capítulo 2 – Eso no tiene lógica: Usa la metáfora para pensar diferente; piensa como poeta, busca similitudes y crea una metáfora del problema para ganar una perspectiva nueva.",
    "Capítulo 2 – Eso no tiene lógica: Busca metáforas a tu alrededor y pon atención a las metáforas que la gente usa para describir lo que hace.",
    "Capítulo 2 – Eso no tiene lógica: Observa las metáforas que usas en tu mente; pueden ser valiosas, pero también pueden encarcelar tu pensamiento si no notas cuánto te guían.",
    "Capítulo 2 – Eso no tiene lógica: Recuerda: este es un mundo ilógico; no todo tiene que cerrar perfecto para ser útil.",
    "Capítulo 3 – Sigue las reglas: Usa metáforas para pensar en algo diferente (piensa como poeta) y así obtener una perspectiva nueva.",
    "Capítulo 3 – Sigue las reglas: Presta atención a las metáforas que usan los demás para describir lo que están haciendo; ahí hay pistas de cómo piensan.",
    "Capítulo 3 – Sigue las reglas: Identifica las metáforas que estás usando en tu propia cabeza; a veces esas son las que encierran tus ideas.",
    "Capítulo 3 – Sigue las reglas: Acepta que vivimos en un mundo ilógico; las cosas no se nombran por precisión, sino para poder darles sentido.",
    "Capítulo 4 – Sé práctico: Rompe rutinas diarias para estimular tu creatividad y ver los problemas desde perspectivas nuevas.",
    "Capítulo 4 – Sé práctico: Cuestiona tus reglas personales y elimina las que ya no aportan, para pensar con mayor libertad.",
    "Capítulo 5 – Jugar es frívolo: Cuando tengas un problema, juégalo; trátalo como un objeto para experimentar, mover, combinar y probar.",
    "Capítulo 5 – Jugar es frívolo: Aunque no tengas un problema, juega igual; puede detonar ideas nuevas que no salen cuando solo piensas en serio.",
    "Capítulo 6 – Esa no es mi área: Adopta actitud de explorador; dondequiera que vayas, hay ideas esperando ser descubiertas.",
    "Capítulo 6 – Esa no es mi área: No te ocupes tanto que pierdas el tiempo libre necesario para explorar (la exploración también es trabajo creativo).",
    "Capítulo 6 – Esa no es mi área: Cuando captures una idea, escríbela de inmediato para que no se pierda.",
    "Capítulo 6 – Esa no es mi área: Pregúntate: ¿Qué recursos y soluciones tengo que estoy asumiendo?, ¿Qué estoy pasando por alto?.",
    "Capítulo 7 – Evitar la ambigüedad: Aprovecha la ambigüedad; en vez de ver algo solo por lo que es, piensa en lo que podría ser.",
    "Capítulo 7 – Evitar la ambigüedad: Si quieres ayuda para resolver algo, exprésalo de manera ambigua a propósito para no restringir la imaginación de los demás.",
    "Capítulo 7 – Evitar la ambigüedad: Permite que la información inesperada estimule tu imaginación en lugar de rechazarla por no encajar.",
    "Capítulo 8 – No parecer tonto: Atrévete a pensar diferente aunque al inicio parezca incorrecto o raro.",
    "Capítulo 8 – No parecer tonto: Haz preguntas simples para descubrir lo que otros dan por hecho y pasan por alto.",
    "Capítulo 8 – No parecer tonto: Cuestiona reglas y costumbres antes de aceptarlas como la única manera.",
    "Capítulo 9 – Equivocarse es malo: Si cometes un error, úsalo como trampolín hacia una idea que de otro modo no habrías descubierto.",
    "Capítulo 9 – Equivocarse es malo: Distingue entre errores de comisión y de omisión; no intentar algo puede costar más que equivocarte; si casi no te equivocas, pregúntate cuántas oportunidades estás dejando pasar por no ser más agresivo.",
    "Capítulo 9 – Equivocarse es malo: Antes de lanzarte a una idea o proyecto, pregúntate: ¿Qué cosas malas pueden pasar si tenemos éxito?.",
    "Capítulo 10 – No soy creativo: Oblígate a probar cosas nuevas y a desarrollar lo que encuentres, sobre todo las ideas pequeñas; la creatividad es tener fe en que esas ideas pequeñas pueden crecer hasta volverse algo grande."
  ];

  const STORAGE_KEY = "dailyAdvice_remainingTips_v1";

  function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }

  function loadRemainingTips() {
    try {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) return [];
      const parsed = JSON.parse(raw);
      if (!Array.isArray(parsed) || parsed.some(t => typeof t !== "string")) return [];
      return parsed;
    } catch {
      return [];
    }
  }

  function saveRemainingTips(arr) {
    try {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
    } catch {
      // If storage is blocked/full, it will just behave like non-persistent mode.
    }
  }

  let remainingTips = loadRemainingTips();

  function getNextTip() {
    if (remainingTips.length === 0) {
      remainingTips = shuffle([...tips]);
    }
    const tip = remainingTips.pop();
    saveRemainingTips(remainingTips);
    return tip;
  }

  function showAdvice() {
    const adviceBox = document.getElementById('adviceBox');
    const adviceText = document.getElementById('adviceText');

    adviceText.textContent = getNextTip();
    adviceBox.classList.add('show');
  }

  // Reto: La pregunta torcida & Piensa como poeta & Hazlo distinto hoy & Jugar sin objetivo & Explorador curioso & Instrucción ambigua & La pregunta obvia & Error productivo & La idea mínima
  const retos = ['torcida', 'poeta', 'distinto', 'jugar', 'explorador', 'ambigua', 'obvia', 'error', 'minima'];
  const RETOS_STORAGE_KEY = "dailyAdvice_remainingRetos_v1";

  function loadRemainingRetos() {
    try {
      const raw = localStorage.getItem(RETOS_STORAGE_KEY);
      if (!raw) return [];
      const parsed = JSON.parse(raw);
      if (!Array.isArray(parsed) || parsed.some(r => typeof r !== "string")) return [];
      return parsed;
    } catch {
      return [];
    }
  }

  function saveRemainingRetos(arr) {
    try {
      localStorage.setItem(RETOS_STORAGE_KEY, JSON.stringify(arr));
    } catch {
      // If storage is blocked/full, it will just behave like non-persistent mode.
    }
  }

  let remainingRetos = loadRemainingRetos();

  function getNextReto() {
    if (remainingRetos.length === 0) {
      remainingRetos = shuffle([...retos]);
    }
    const reto = remainingRetos.pop();
    saveRemainingRetos(remainingRetos);
    return reto;
  }

  let currentRetoType = '';
  let currentRetoStep = 0;
  let retoAnswers = [];

  function showReto() {
    const retoBox = document.getElementById('retoBox');

    if (currentRetoStep === 0) {
      // Get next reto from shuffled queue
      currentRetoType = getNextReto();
      
      if (currentRetoType === 'torcida') {
        showTorcidaStep1();
      } else if (currentRetoType === 'poeta') {
        showPoetaStep1();
      } else if (currentRetoType === 'distinto') {
        showDistintoStep1();
      } else if (currentRetoType === 'jugar') {
        showJugarStep1();
      } else if (currentRetoType === 'explorador') {
        showExploradorStep1();
      } else if (currentRetoType === 'ambigua') {
        showAmbiguaStep1();
      } else if (currentRetoType === 'obvia') {
        showObviaStep1();
      } else if (currentRetoType === 'error') {
        showErrorStep1();
      } else if (currentRetoType === 'minima') {
        showMinimaStep1();
      }
      
      retoBox.classList.add('show');
      currentRetoStep = 1;
    }
  }

  // LA PREGUNTA TORCIDA
  function showTorcidaStep1() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">La pregunta torcida</h2>
        <p style="color: #666; margin-bottom: 15px; font-size: 1em;">¿Cuál es tu problema?</p>
        <textarea id="retoInput" placeholder="..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 1em; resize: vertical; min-height: 80px;"></textarea>
        <button onclick="nextRetoStep()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Siguiente</button>
      </div>
    `;
  }

  function showTorcidaStep2() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">La pregunta torcida</h2>
        <p style="color: #999; margin-bottom: 20px; padding: 10px; background: #f0f0f0; border-radius: 8px; font-size: 0.95em;">${retoAnswers[0]}</p>
        <p style="color: #666; margin-bottom: 15px; font-size: 1em;">Reescribe tu problema cambiando las palabras:</p>
        <textarea id="retoInput" placeholder="..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 1em; resize: vertical; min-height: 80px;"></textarea>
        <button onclick="nextRetoStep()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Siguiente</button>
      </div>
    `;
  }

  function showTorcidaStep3() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">La pregunta torcida</h2>
        <p style="color: #999; margin-bottom: 15px; padding: 10px; background: #f0f0f0; border-radius: 8px; font-size: 0.95em;">${retoAnswers[1]}</p>
        <p style="color: #666; margin-bottom: 15px; font-size: 1em;">Reescríbelo una vez más:</p>
        <textarea id="retoInput" placeholder="..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 1em; resize: vertical; min-height: 80px;"></textarea>
        <button onclick="nextRetoStep()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Siguiente</button>
      </div>
    `;
  }

  function showTorcidaStep4() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">La pregunta torcida</h2>
        <p style="color: #999; margin-bottom: 15px; padding: 10px; background: #f0f0f0; border-radius: 8px; font-size: 0.95em;">${retoAnswers[2]}</p>
        <p style="color: #666; margin-bottom: 15px; font-size: 1em;">Una última versión:</p>
        <textarea id="retoInput" placeholder="..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 1em; resize: vertical; min-height: 80px;"></textarea>
        <button onclick="nextRetoStep()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Siguiente</button>
      </div>
    `;
  }

  function showTorcidaStep5() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">La pregunta torcida</h2>
        <p style="color: #999; margin-bottom: 15px; padding: 10px; background: #f0f0f0; border-radius: 8px; font-size: 0.95em;">${retoAnswers[3]}</p>
        <p style="color: #666; margin-bottom: 15px; font-size: 1em;">Anota mínimo 5 soluciones:</p>
        <textarea id="retoInput" placeholder="..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 1em; resize: vertical; min-height: 120px;"></textarea>
        <button onclick="finishReto()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Finalizar</button>
      </div>
    `;
  }

  // PIENSA COMO POETA
  function showPoetaStep1() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Piensa como poeta</h2>
        <p style="color: #666; margin-bottom: 15px; font-size: 1em;">Completa: "Este problema es como ______ porque ______"</p>
        <textarea id="retoInput" placeholder="..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 1em; resize: vertical; min-height: 80px;"></textarea>
        <button onclick="nextRetoStep()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Siguiente</button>
      </div>
    `;
  }

  function showPoetaStep2() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Piensa como poeta</h2>
        <p style="color: #999; margin-bottom: 20px; padding: 10px; background: #f0f0f0; border-radius: 8px; font-size: 0.95em;">${retoAnswers[0]}</p>
        <p style="color: #666; margin-bottom: 15px; font-size: 1em;">Crea una segunda metáfora distinta:</p>
        <textarea id="retoInput" placeholder="..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 1em; resize: vertical; min-height: 80px;"></textarea>
        <button onclick="nextRetoStep()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Siguiente</button>
      </div>
    `;
  }

  function showPoetaStep3() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Piensa como poeta</h2>
        <p style="color: #999; margin-bottom: 15px; padding: 10px; background: #f0f0f0; border-radius: 8px; font-size: 0.95em;">${retoAnswers[0]}</p>
        <p style="color: #999; margin-bottom: 20px; padding: 10px; background: #f0f0f0; border-radius: 8px; font-size: 0.95em;">${retoAnswers[1]}</p>
        <p style="color: #666; margin-bottom: 15px; font-size: 1em;">¿Qué nueva idea surge de estas metáforas?</p>
        <textarea id="retoInput" placeholder="..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 1em; resize: vertical; min-height: 100px;"></textarea>
        <button onclick="finishReto()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Finalizar</button>
      </div>
    `;
  }

  // HAZLO DISTINTO HOY
  function showDistintoStep1() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Hazlo distinto hoy</h2>
        <p style="color: #666; margin-bottom: 20px; font-size: 1em;">Piensa en tu rutina diaria.</p>
        <button onclick="nextRetoStep()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Siguiente</button>
      </div>
    `;
  }

  function showDistintoStep2() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Hazlo distinto hoy</h2>
        <p style="color: #666; margin-bottom: 20px; font-size: 1em;">Rompe tu rutina hoy. Haz algo diferente. Regresa después.</p>
        <button onclick="nextRetoStep()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Siguiente</button>
      </div>
    `;
  }

  function showDistintoStep3() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Hazlo distinto hoy</h2>
        <p style="color: #666; margin-bottom: 15px; font-size: 1em;">¿Qué idea o pensamiento nuevo apareció?</p>
        <textarea id="retoInput" placeholder="..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 1em; resize: vertical; min-height: 120px;"></textarea>
        <button onclick="finishReto()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Finalizar</button>
      </div>
    `;
  }

  // JUGAR SIN OBJETIVO
  let timerInterval = null;
  let timeLeft = 120;

  function showJugarStep1() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Jugar sin objetivo</h2>
        <p style="color: #666; margin-bottom: 20px; font-size: 1em;">Toma un objeto cercano.</p>
        <button onclick="nextRetoStep()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Siguiente</button>
      </div>
    `;
  }

  function showJugarStep2() {
    const retoBox = document.getElementById('retoBox');
    timeLeft = 120;
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Jugar sin objetivo</h2>
        <p style="color: #666; margin-bottom: 15px; font-size: 1em; text-align: center;">Juega con él sin propósito durante 2 minutos.</p>
        <div style="text-align: center; margin: 30px 0;">
          <div id="timerDisplay" style="font-size: 3em; font-weight: bold; color: #FF4500; font-family: monospace;">2:00</div>
        </div>
        <div style="display: flex; gap: 10px; justify-content: center;">
          <button id="timerBtn" onclick="toggleTimer()" style="background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%); color: white; border: none; padding: 12px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; font-size: 1em;">Iniciar</button>
          <button onclick="skipTimer()" style="background: linear-gradient(135deg, #888 0%, #666 100%); color: white; border: none; padding: 12px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; font-size: 1em;">Saltar</button>
        </div>
      </div>
    `;
  }

  function toggleTimer() {
    const btn = document.getElementById('timerBtn');
    
    if (timerInterval) {
      // Pause
      clearInterval(timerInterval);
      timerInterval = null;
      btn.textContent = 'Continuar';
      btn.style.background = 'linear-gradient(135deg, #4CAF50 0%, #45a049 100%)';
    } else {
      // Start/Resume
      btn.textContent = 'Pausar';
      btn.style.background = 'linear-gradient(135deg, #ff6b6b 0%, #ee5a5a 100%)';
      timerInterval = setInterval(() => {
        timeLeft--;
        updateTimerDisplay();
        
        if (timeLeft <= 0) {
          clearInterval(timerInterval);
          timerInterval = null;
          timerComplete();
        }
      }, 1000);
    }
  }

  function updateTimerDisplay() {
    const display = document.getElementById('timerDisplay');
    const minutes = Math.floor(timeLeft / 60);
    const seconds = timeLeft % 60;
    display.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
    
    // Change color when low
    if (timeLeft <= 10) {
      display.style.color = '#ff0000';
    } else if (timeLeft <= 30) {
      display.style.color = '#ff6b6b';
    }
  }

  function skipTimer() {
    if (timerInterval) {
      clearInterval(timerInterval);
      timerInterval = null;
    }
    timerComplete();
  }

  function timerComplete() {
    retoAnswers.push('timer_completed');
    showJugarStep3();
    currentRetoStep = 3;
  }

  function showJugarStep3() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Jugar sin objetivo</h2>
        <p style="color: #666; margin-bottom: 15px; font-size: 1em;">Relaciónalo con tu problema, aunque no tenga sentido:</p>
        <textarea id="retoInput" placeholder="..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 1em; resize: vertical; min-height: 100px;"></textarea>
        <button onclick="finishReto()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Finalizar</button>
      </div>
    `;
  }

  // EXPLORADOR CURIOSO
  function showExploradorStep1() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Explorador curioso</h2>
        <p style="color: #666; margin-bottom: 20px; font-size: 1em; line-height: 1.8;">
          1. Piensa en un área que no sea la tuya.<br>
          2. Pregúntate: ¿Cómo lo resolvería alguien de esa área?
        </p>
        <button onclick="nextRetoStep()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Siguiente</button>
      </div>
    `;
  }

  function showExploradorStep2() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Explorador curioso</h2>
        <p style="color: #666; margin-bottom: 15px; font-size: 1em;">Escribe la idea:</p>
        <textarea id="retoInput" placeholder="..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 1em; resize: vertical; min-height: 120px;"></textarea>
        <button onclick="finishReto()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Finalizar</button>
      </div>
    `;
  }

  // INSTRUCCIÓN AMBIGUA
  function showAmbiguaStep1() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Instrucción ambigua</h2>
        <p style="color: #666; margin-bottom: 15px; font-size: 1em;">Describe tu problema usando solo frases vagas:</p>
        <textarea id="retoInput" placeholder="..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 1em; resize: vertical; min-height: 100px;"></textarea>
        <button onclick="nextRetoStep()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Siguiente</button>
      </div>
    `;
  }

  function showAmbiguaStep2() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Instrucción ambigua</h2>
        <p style="color: #999; margin-bottom: 20px; padding: 10px; background: #f0f0f0; border-radius: 8px; font-size: 0.95em;">${retoAnswers[0]}</p>
        <p style="color: #666; margin-bottom: 15px; font-size: 1em;">Pídele a alguien una solución y escríbela:</p>
        <textarea id="retoInput" placeholder="..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 1em; resize: vertical; min-height: 100px;"></textarea>
        <button onclick="finishReto()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Finalizar</button>
      </div>
    `;
  }

  // LA PREGUNTA OBVIA
  function showObviaStep1() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">La pregunta obvia</h2>
        <p style="color: #666; margin-bottom: 15px; font-size: 1em;">Escribe la pregunta más simple que se te ocurra:</p>
        <textarea id="retoInput" placeholder="..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 1em; resize: vertical; min-height: 80px;"></textarea>
        <button onclick="nextRetoStep()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Siguiente</button>
      </div>
    `;
  }

  function showObviaStep2() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">La pregunta obvia</h2>
        <p style="color: #999; margin-bottom: 20px; padding: 10px; background: #f0f0f0; border-radius: 8px; font-size: 0.95em;">${retoAnswers[0]}</p>
        <p style="color: #666; margin-bottom: 15px; font-size: 1em;">Respóndela sin justificarte:</p>
        <textarea id="retoInput" placeholder="..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 1em; resize: vertical; min-height: 80px;"></textarea>
        <button onclick="nextRetoStep()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Siguiente</button>
      </div>
    `;
  }

  function showObviaStep3() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">La pregunta obvia</h2>
        <p style="color: #999; margin-bottom: 15px; padding: 10px; background: #f0f0f0; border-radius: 8px; font-size: 0.95em;">${retoAnswers[0]}</p>
        <p style="color: #999; margin-bottom: 20px; padding: 10px; background: #f0f0f0; border-radius: 8px; font-size: 0.95em;">${retoAnswers[1]}</p>
        <p style="color: #666; margin-bottom: 15px; font-size: 1em;">Busca algo que nadie más esté cuestionando:</p>
        <textarea id="retoInput" placeholder="..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 1em; resize: vertical; min-height: 80px;"></textarea>
        <button onclick="finishReto()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Finalizar</button>
      </div>
    `;
  }

  // ERROR PRODUCTIVO
  function showErrorStep1() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Error productivo</h2>
        <p style="color: #666; margin-bottom: 15px; font-size: 1em;">Recuerda un error reciente:</p>
        <textarea id="retoInput" placeholder="..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 1em; resize: vertical; min-height: 80px;"></textarea>
        <button onclick="nextRetoStep()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Siguiente</button>
      </div>
    `;
  }

  function showErrorStep2() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Error productivo</h2>
        <p style="color: #999; margin-bottom: 20px; padding: 10px; background: #f0f0f0; border-radius: 8px; font-size: 0.95em;">${retoAnswers[0]}</p>
        <div style="margin-bottom: 15px;">
          <p style="color: #666; margin-bottom: 8px; font-size: 0.95em;">¿Qué aprendí?</p>
          <textarea id="retoInput1" placeholder="..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 0.95em; resize: vertical; min-height: 60px;"></textarea>
        </div>
        <div style="margin-bottom: 15px;">
          <p style="color: #666; margin-bottom: 8px; font-size: 0.95em;">¿Qué idea surgió gracias a él?</p>
          <textarea id="retoInput2" placeholder="..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 0.95em; resize: vertical; min-height: 60px;"></textarea>
        </div>
        <div style="margin-bottom: 15px;">
          <p style="color: #666; margin-bottom: 8px; font-size: 0.95em;">¿Qué oportunidad habría perdido si no fallaba?</p>
          <textarea id="retoInput3" placeholder="..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 0.95em; resize: vertical; min-height: 60px;"></textarea>
        </div>
        <button onclick="finishErrorReto()" style="margin-top: 10px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Finalizar</button>
      </div>
    `;
  }

  function finishErrorReto() {
    const input1 = document.getElementById('retoInput1');
    const input2 = document.getElementById('retoInput2');
    const input3 = document.getElementById('retoInput3');
    
    if (!input1.value.trim() || !input2.value.trim() || !input3.value.trim()) {
      alert('Por favor, completa las tres reflexiones antes de continuar.');
      return;
    }
    
    retoAnswers.push({
      aprendizaje: input1.value.trim(),
      idea: input2.value.trim(),
      oportunidad: input3.value.trim()
    });
    
    finishRetoWithMessage('Error productivo');
  }

  // LA IDEA MÍNIMA
  let minimaIteration = 0;

  function showMinimaStep1() {
    const retoBox = document.getElementById('retoBox');
    minimaIteration = 1;
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">La idea mínima</h2>
        <p style="color: #666; margin-bottom: 15px; font-size: 1em;">(${minimaIteration}/3) Escribe la idea más pequeña que tengas:</p>
        <textarea id="retoInput" placeholder="..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 1em; resize: vertical; min-height: 80px;"></textarea>
        <button onclick="nextRetoStep()" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">Siguiente</button>
      </div>
    `;
  }

  function showMinimaIteration() {
    const retoBox = document.getElementById('retoBox');
    const lastIdea = retoAnswers[retoAnswers.length - 1];
    const isLastIteration = minimaIteration === 3;
    
    retoBox.innerHTML = `
      <div style="text-align: left;">
        <h2 style="text-align: center; color: #333; margin-bottom: 20px;">La idea mínima</h2>
        <p style="color: #999; margin-bottom: 20px; padding: 10px; background: #f0f0f0; border-radius: 8px; font-size: 0.95em;">${lastIdea}</p>
        <p style="color: #666; margin-bottom: 15px; font-size: 1em;">(${minimaIteration}/3) Agrega una mejora mínima:</p>
        <textarea id="retoInput" placeholder="..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 1em; resize: vertical; min-height: 80px;"></textarea>
        <button onclick="${isLastIteration ? 'finishMinimaFromButton()' : 'nextRetoStep()'}" style="margin-top: 15px; background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; width: 100%;">${isLastIteration ? 'Finalizar' : 'Siguiente'}</button>
      </div>
    `;
  }

  function finishMinimaFromButton() {
    const input = document.getElementById('retoInput');
    if (!input.value.trim()) {
      alert('Por favor, escribe algo antes de continuar.');
      return;
    }
    retoAnswers.push(input.value.trim());
    finishMinimaReto();
  }

  function finishMinimaReto() {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: center;">
        <h2 style="color: #333; margin-bottom: 20px;">¡Felicidades!</h2>
        <p style="color: #666; margin-bottom: 20px; font-size: 1.1em;">Has completado exitosamente "La idea mínima".</p>
        <p style="color: #764ba2; margin-bottom: 30px; font-size: 1.3em; font-weight: 600; font-style: italic; padding: 20px; background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%); border-radius: 10px;">
          "No busques grandeza, busca continuidad."
        </p>
        <button onclick="resetReto()" style="background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 12px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; font-size: 1em;">Volver a Inicio</button>
      </div>
    `;
    
    // Reset for next time
    currentRetoStep = 0;
    retoAnswers = [];
    currentRetoType = '';
    minimaIteration = 0;
  }

  function finishRetoWithMessage(retoTitle) {
    const retoBox = document.getElementById('retoBox');
    
    retoBox.innerHTML = `
      <div style="text-align: center;">
        <h2 style="color: #333; margin-bottom: 20px;">¡Felicidades!</h2>
        <p style="color: #666; margin-bottom: 30px; font-size: 1.1em;">Has completado exitosamente "${retoTitle}".</p>
        <button onclick="resetReto()" style="background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 12px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; font-size: 1em;">Volver a Inicio</button>
      </div>
    `;
    
    // Reset for next time
    currentRetoStep = 0;
    retoAnswers = [];
    currentRetoType = '';
  }

  function nextRetoStep() {
    const input = document.getElementById('retoInput');
    
    // For distinto steps 1 and 2, no input validation needed (no textarea)
    if (currentRetoType === 'distinto' && (currentRetoStep === 1 || currentRetoStep === 2)) {
      retoAnswers.push('completed');
      if (currentRetoStep === 1) {
        showDistintoStep2();
        currentRetoStep = 2;
      } else if (currentRetoStep === 2) {
        showDistintoStep3();
        currentRetoStep = 3;
      }
      return;
    }

    // For jugar step 1, no input validation needed (no textarea)
    if (currentRetoType === 'jugar' && currentRetoStep === 1) {
      retoAnswers.push('has_object');
      showJugarStep2();
      currentRetoStep = 2;
      return;
    }

    // For explorador step 1, no input validation needed (no textarea)
    if (currentRetoType === 'explorador' && currentRetoStep === 1) {
      retoAnswers.push('thought_complete');
      showExploradorStep2();
      currentRetoStep = 2;
      return;
    }

    // For ambigua steps
    if (currentRetoType === 'ambigua') {
      if (!document.getElementById('retoInput').value.trim()) {
        alert('Por favor, escribe algo antes de continuar.');
        return;
      }
      retoAnswers.push(document.getElementById('retoInput').value.trim());
      if (currentRetoStep === 1) {
        showAmbiguaStep2();
        currentRetoStep = 2;
      }
      return;
    }

    // For obvia steps
    if (currentRetoType === 'obvia') {
      if (!document.getElementById('retoInput').value.trim()) {
        alert('Por favor, escribe algo antes de continuar.');
        return;
      }
      retoAnswers.push(document.getElementById('retoInput').value.trim());
      if (currentRetoStep === 1) {
        showObviaStep2();
        currentRetoStep = 2;
      } else if (currentRetoStep === 2) {
        showObviaStep3();
        currentRetoStep = 3;
      }
      return;
    }

    // For error steps
    if (currentRetoType === 'error') {
      if (!document.getElementById('retoInput').value.trim()) {
        alert('Por favor, escribe algo antes de continuar.');
        return;
      }
      retoAnswers.push(document.getElementById('retoInput').value.trim());
      if (currentRetoStep === 1) {
        showErrorStep2();
        currentRetoStep = 2;
      }
      return;
    }

    // For minima steps
    if (currentRetoType === 'minima') {
      if (!document.getElementById('retoInput').value.trim()) {
        alert('Por favor, escribe algo antes de continuar.');
        return;
      }
      retoAnswers.push(document.getElementById('retoInput').value.trim());
      minimaIteration++;
      if (minimaIteration <= 3) {
        showMinimaIteration();
        currentRetoStep = minimaIteration;
      }
      if (minimaIteration > 3) {
        finishMinimaReto();
      }
      return;
    }
    
    if (!input.value.trim()) {
      alert('Por favor, escribe algo antes de continuar.');
      return;
    }

    retoAnswers.push(input.value.trim());
    
    if (currentRetoType === 'torcida') {
      if (currentRetoStep === 1) {
        showTorcidaStep2();
        currentRetoStep = 2;
      } else if (currentRetoStep === 2) {
        showTorcidaStep3();
        currentRetoStep = 3;
      } else if (currentRetoStep === 3) {
        showTorcidaStep4();
        currentRetoStep = 4;
      } else if (currentRetoStep === 4) {
        showTorcidaStep5();
        currentRetoStep = 5;
      }
    } else if (currentRetoType === 'poeta') {
      if (currentRetoStep === 1) {
        showPoetaStep2();
        currentRetoStep = 2;
      } else if (currentRetoStep === 2) {
        showPoetaStep3();
        currentRetoStep = 3;
      }
    }
  }

  function finishReto() {
    const input = document.getElementById('retoInput');
    
    if (!input.value.trim()) {
      alert('Por favor, escribe algo antes de continuar.');
      return;
    }

    if (currentRetoType === 'torcida' && currentRetoStep === 5) {
      const lines = input.value.trim().split('\n').filter(line => line.trim().length > 0);
      if (lines.length < 3) {
        alert('Por favor, anota mínimo 5 soluciones.');
        return;
      }
    }

    const retoBox = document.getElementById('retoBox');
    let retoTitle = '';
    
    if (currentRetoType === 'torcida') {
      retoTitle = 'La pregunta torcida';
    } else if (currentRetoType === 'poeta') {
      retoTitle = 'Piensa como poeta';
    } else if (currentRetoType === 'distinto') {
      retoTitle = 'Hazlo distinto hoy';
    } else if (currentRetoType === 'jugar') {
      retoTitle = 'Jugar sin objetivo';
    } else if (currentRetoType === 'explorador') {
      retoTitle = 'Explorador curioso';
    } else if (currentRetoType === 'ambigua') {
      retoTitle = 'Instrucción ambigua';
    } else if (currentRetoType === 'obvia') {
      retoTitle = 'La pregunta obvia';
    } else if (currentRetoType === 'error') {
      retoTitle = 'Error productivo';
    } else if (currentRetoType === 'minima') {
      retoTitle = 'La idea mínima';
    }
    
    retoBox.innerHTML = `
      <div style="text-align: center;">
        <h2 style="color: #333; margin-bottom: 20px;">Felicidades</h2>
        <p style="color: #666; margin-bottom: 30px; font-size: 1.1em;">Has completado exitosamente "${retoTitle}".</p>
        <button onclick="resetReto()" style="background: linear-gradient(135deg, #9b59b6 0%, #1a1a2e 100%); color: white; border: none; padding: 12px 30px; border-radius: 25px; cursor: pointer; font-weight: 600; font-size: 1em;">Volver a Inicio</button>
      </div>
    `;
    
    // Reset for next time
    currentRetoStep = 0;
    retoAnswers = [];
    currentRetoType = '';
  }

  function resetReto() {
    currentRetoStep = 0;
    retoAnswers = [];
    currentRetoType = '';
    minimaIteration = 0;
    // Clean up timer if active
    if (timerInterval) {
      clearInterval(timerInterval);
      timerInterval = null;
    }
    timeLeft = 120;
    const retoBox = document.getElementById('retoBox');
    retoBox.classList.remove('show');
  }
</script>
</body>
</html>
